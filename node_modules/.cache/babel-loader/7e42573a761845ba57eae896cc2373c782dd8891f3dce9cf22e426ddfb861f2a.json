{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { context, diag, propagation, trace } from '@opentelemetry/api';\nimport { CompositePropagator, W3CBaggagePropagator, W3CTraceContextPropagator, getEnv, merge } from '@opentelemetry/core';\nimport { Resource } from '@opentelemetry/resources';\nimport { Tracer } from '.';\nimport { loadDefaultConfig } from './config';\nimport { MultiSpanProcessor } from './MultiSpanProcessor';\nimport { NoopSpanProcessor } from './export/NoopSpanProcessor';\nimport { BatchSpanProcessor } from './platform';\nimport { reconfigureLimits } from './utility';\nexport var ForceFlushState;\n(function (ForceFlushState) {\n  ForceFlushState[ForceFlushState[\"resolved\"] = 0] = \"resolved\";\n  ForceFlushState[ForceFlushState[\"timeout\"] = 1] = \"timeout\";\n  ForceFlushState[ForceFlushState[\"error\"] = 2] = \"error\";\n  ForceFlushState[ForceFlushState[\"unresolved\"] = 3] = \"unresolved\";\n})(ForceFlushState || (ForceFlushState = {}));\n/**\n * This class represents a basic tracer provider which platform libraries can extend\n */\nvar BasicTracerProvider = /** @class */function () {\n  function BasicTracerProvider(config) {\n    if (config === void 0) {\n      config = {};\n    }\n    var _a;\n    this._registeredSpanProcessors = [];\n    this._tracers = new Map();\n    var mergedConfig = merge({}, loadDefaultConfig(), reconfigureLimits(config));\n    this.resource = (_a = mergedConfig.resource) !== null && _a !== void 0 ? _a : Resource.empty();\n    this.resource = Resource.default().merge(this.resource);\n    this._config = Object.assign({}, mergedConfig, {\n      resource: this.resource\n    });\n    var defaultExporter = this._buildExporterFromEnv();\n    if (defaultExporter !== undefined) {\n      var batchProcessor = new BatchSpanProcessor(defaultExporter);\n      this.activeSpanProcessor = batchProcessor;\n    } else {\n      this.activeSpanProcessor = new NoopSpanProcessor();\n    }\n  }\n  BasicTracerProvider.prototype.getTracer = function (name, version, options) {\n    var key = name + \"@\" + (version || '') + \":\" + ((options === null || options === void 0 ? void 0 : options.schemaUrl) || '');\n    if (!this._tracers.has(key)) {\n      this._tracers.set(key, new Tracer({\n        name: name,\n        version: version,\n        schemaUrl: options === null || options === void 0 ? void 0 : options.schemaUrl\n      }, this._config, this));\n    }\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return this._tracers.get(key);\n  };\n  /**\n   * Adds a new {@link SpanProcessor} to this tracer.\n   * @param spanProcessor the new SpanProcessor to be added.\n   */\n  BasicTracerProvider.prototype.addSpanProcessor = function (spanProcessor) {\n    if (this._registeredSpanProcessors.length === 0) {\n      // since we might have enabled by default a batchProcessor, we disable it\n      // before adding the new one\n      this.activeSpanProcessor.shutdown().catch(function (err) {\n        return diag.error('Error while trying to shutdown current span processor', err);\n      });\n    }\n    this._registeredSpanProcessors.push(spanProcessor);\n    this.activeSpanProcessor = new MultiSpanProcessor(this._registeredSpanProcessors);\n  };\n  BasicTracerProvider.prototype.getActiveSpanProcessor = function () {\n    return this.activeSpanProcessor;\n  };\n  /**\n   * Register this TracerProvider for use with the OpenTelemetry API.\n   * Undefined values may be replaced with defaults, and\n   * null values will be skipped.\n   *\n   * @param config Configuration object for SDK registration\n   */\n  BasicTracerProvider.prototype.register = function (config) {\n    if (config === void 0) {\n      config = {};\n    }\n    trace.setGlobalTracerProvider(this);\n    if (config.propagator === undefined) {\n      config.propagator = this._buildPropagatorFromEnv();\n    }\n    if (config.contextManager) {\n      context.setGlobalContextManager(config.contextManager);\n    }\n    if (config.propagator) {\n      propagation.setGlobalPropagator(config.propagator);\n    }\n  };\n  BasicTracerProvider.prototype.forceFlush = function () {\n    var timeout = this._config.forceFlushTimeoutMillis;\n    var promises = this._registeredSpanProcessors.map(function (spanProcessor) {\n      return new Promise(function (resolve) {\n        var state;\n        var timeoutInterval = setTimeout(function () {\n          resolve(new Error(\"Span processor did not completed within timeout period of \" + timeout + \" ms\"));\n          state = ForceFlushState.timeout;\n        }, timeout);\n        spanProcessor.forceFlush().then(function () {\n          clearTimeout(timeoutInterval);\n          if (state !== ForceFlushState.timeout) {\n            state = ForceFlushState.resolved;\n            resolve(state);\n          }\n        }).catch(function (error) {\n          clearTimeout(timeoutInterval);\n          state = ForceFlushState.error;\n          resolve(error);\n        });\n      });\n    });\n    return new Promise(function (resolve, reject) {\n      Promise.all(promises).then(function (results) {\n        var errors = results.filter(function (result) {\n          return result !== ForceFlushState.resolved;\n        });\n        if (errors.length > 0) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      }).catch(function (error) {\n        return reject([error]);\n      });\n    });\n  };\n  BasicTracerProvider.prototype.shutdown = function () {\n    return this.activeSpanProcessor.shutdown();\n  };\n  /**\n   * TS cannot yet infer the type of this.constructor:\n   * https://github.com/Microsoft/TypeScript/issues/3841#issuecomment-337560146\n   * There is no need to override either of the getters in your child class.\n   * The type of the registered component maps should be the same across all\n   * classes in the inheritance tree.\n   */\n  BasicTracerProvider.prototype._getPropagator = function (name) {\n    var _a;\n    return (_a = this.constructor._registeredPropagators.get(name)) === null || _a === void 0 ? void 0 : _a();\n  };\n  BasicTracerProvider.prototype._getSpanExporter = function (name) {\n    var _a;\n    return (_a = this.constructor._registeredExporters.get(name)) === null || _a === void 0 ? void 0 : _a();\n  };\n  BasicTracerProvider.prototype._buildPropagatorFromEnv = function () {\n    var _this = this;\n    // per spec, propagators from env must be deduplicated\n    var uniquePropagatorNames = Array.from(new Set(getEnv().OTEL_PROPAGATORS));\n    var propagators = uniquePropagatorNames.map(function (name) {\n      var propagator = _this._getPropagator(name);\n      if (!propagator) {\n        diag.warn(\"Propagator \\\"\" + name + \"\\\" requested through environment variable is unavailable.\");\n      }\n      return propagator;\n    });\n    var validPropagators = propagators.reduce(function (list, item) {\n      if (item) {\n        list.push(item);\n      }\n      return list;\n    }, []);\n    if (validPropagators.length === 0) {\n      return;\n    } else if (uniquePropagatorNames.length === 1) {\n      return validPropagators[0];\n    } else {\n      return new CompositePropagator({\n        propagators: validPropagators\n      });\n    }\n  };\n  BasicTracerProvider.prototype._buildExporterFromEnv = function () {\n    var exporterName = getEnv().OTEL_TRACES_EXPORTER;\n    if (exporterName === 'none' || exporterName === '') return;\n    var exporter = this._getSpanExporter(exporterName);\n    if (!exporter) {\n      diag.error(\"Exporter \\\"\" + exporterName + \"\\\" requested through environment variable is unavailable.\");\n    }\n    return exporter;\n  };\n  BasicTracerProvider._registeredPropagators = new Map([['tracecontext', function () {\n    return new W3CTraceContextPropagator();\n  }], ['baggage', function () {\n    return new W3CBaggagePropagator();\n  }]]);\n  BasicTracerProvider._registeredExporters = new Map();\n  return BasicTracerProvider;\n}();\nexport { BasicTracerProvider };","map":{"version":3,"names":["context","diag","propagation","trace","CompositePropagator","W3CBaggagePropagator","W3CTraceContextPropagator","getEnv","merge","Resource","Tracer","loadDefaultConfig","MultiSpanProcessor","NoopSpanProcessor","BatchSpanProcessor","reconfigureLimits","ForceFlushState","BasicTracerProvider","config","_registeredSpanProcessors","_tracers","Map","mergedConfig","resource","_a","empty","default","_config","Object","assign","defaultExporter","_buildExporterFromEnv","undefined","batchProcessor","activeSpanProcessor","prototype","getTracer","name","version","options","key","schemaUrl","has","set","get","addSpanProcessor","spanProcessor","length","shutdown","catch","err","error","push","getActiveSpanProcessor","register","setGlobalTracerProvider","propagator","_buildPropagatorFromEnv","contextManager","setGlobalContextManager","setGlobalPropagator","forceFlush","timeout","forceFlushTimeoutMillis","promises","map","Promise","resolve","state","timeoutInterval","setTimeout","Error","then","clearTimeout","resolved","reject","all","results","errors","filter","result","_getPropagator","constructor","_registeredPropagators","_getSpanExporter","_registeredExporters","_this","uniquePropagatorNames","Array","from","Set","OTEL_PROPAGATORS","propagators","warn","validPropagators","reduce","list","item","exporterName","OTEL_TRACES_EXPORTER","exporter"],"sources":["/home/egor/node_modules/@opentelemetry/sdk-trace-base/src/BasicTracerProvider.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  context,\n  diag,\n  propagation,\n  TextMapPropagator,\n  trace,\n  TracerProvider,\n} from '@opentelemetry/api';\nimport {\n  CompositePropagator,\n  W3CBaggagePropagator,\n  W3CTraceContextPropagator,\n  getEnv,\n  merge,\n} from '@opentelemetry/core';\nimport { IResource, Resource } from '@opentelemetry/resources';\nimport { SpanProcessor, Tracer } from '.';\nimport { loadDefaultConfig } from './config';\nimport { MultiSpanProcessor } from './MultiSpanProcessor';\nimport { NoopSpanProcessor } from './export/NoopSpanProcessor';\nimport { SDKRegistrationConfig, TracerConfig } from './types';\nimport { SpanExporter } from './export/SpanExporter';\nimport { BatchSpanProcessor } from './platform';\nimport { reconfigureLimits } from './utility';\n\nexport type PROPAGATOR_FACTORY = () => TextMapPropagator;\nexport type EXPORTER_FACTORY = () => SpanExporter;\n\nexport enum ForceFlushState {\n  'resolved',\n  'timeout',\n  'error',\n  'unresolved',\n}\n\n/**\n * This class represents a basic tracer provider which platform libraries can extend\n */\nexport class BasicTracerProvider implements TracerProvider {\n  protected static readonly _registeredPropagators = new Map<\n    string,\n    PROPAGATOR_FACTORY\n  >([\n    ['tracecontext', () => new W3CTraceContextPropagator()],\n    ['baggage', () => new W3CBaggagePropagator()],\n  ]);\n\n  protected static readonly _registeredExporters = new Map<\n    string,\n    EXPORTER_FACTORY\n  >();\n\n  private readonly _config: TracerConfig;\n  private readonly _registeredSpanProcessors: SpanProcessor[] = [];\n  private readonly _tracers: Map<string, Tracer> = new Map();\n\n  activeSpanProcessor: SpanProcessor;\n  readonly resource: IResource;\n\n  constructor(config: TracerConfig = {}) {\n    const mergedConfig = merge(\n      {},\n      loadDefaultConfig(),\n      reconfigureLimits(config)\n    );\n    this.resource = mergedConfig.resource ?? Resource.empty();\n    this.resource = Resource.default().merge(this.resource);\n    this._config = Object.assign({}, mergedConfig, {\n      resource: this.resource,\n    });\n\n    const defaultExporter = this._buildExporterFromEnv();\n    if (defaultExporter !== undefined) {\n      const batchProcessor = new BatchSpanProcessor(defaultExporter);\n      this.activeSpanProcessor = batchProcessor;\n    } else {\n      this.activeSpanProcessor = new NoopSpanProcessor();\n    }\n  }\n\n  getTracer(\n    name: string,\n    version?: string,\n    options?: { schemaUrl?: string }\n  ): Tracer {\n    const key = `${name}@${version || ''}:${options?.schemaUrl || ''}`;\n    if (!this._tracers.has(key)) {\n      this._tracers.set(\n        key,\n        new Tracer(\n          { name, version, schemaUrl: options?.schemaUrl },\n          this._config,\n          this\n        )\n      );\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return this._tracers.get(key)!;\n  }\n\n  /**\n   * Adds a new {@link SpanProcessor} to this tracer.\n   * @param spanProcessor the new SpanProcessor to be added.\n   */\n  addSpanProcessor(spanProcessor: SpanProcessor): void {\n    if (this._registeredSpanProcessors.length === 0) {\n      // since we might have enabled by default a batchProcessor, we disable it\n      // before adding the new one\n      this.activeSpanProcessor\n        .shutdown()\n        .catch(err =>\n          diag.error(\n            'Error while trying to shutdown current span processor',\n            err\n          )\n        );\n    }\n    this._registeredSpanProcessors.push(spanProcessor);\n    this.activeSpanProcessor = new MultiSpanProcessor(\n      this._registeredSpanProcessors\n    );\n  }\n\n  getActiveSpanProcessor(): SpanProcessor {\n    return this.activeSpanProcessor;\n  }\n\n  /**\n   * Register this TracerProvider for use with the OpenTelemetry API.\n   * Undefined values may be replaced with defaults, and\n   * null values will be skipped.\n   *\n   * @param config Configuration object for SDK registration\n   */\n  register(config: SDKRegistrationConfig = {}): void {\n    trace.setGlobalTracerProvider(this);\n    if (config.propagator === undefined) {\n      config.propagator = this._buildPropagatorFromEnv();\n    }\n\n    if (config.contextManager) {\n      context.setGlobalContextManager(config.contextManager);\n    }\n\n    if (config.propagator) {\n      propagation.setGlobalPropagator(config.propagator);\n    }\n  }\n\n  forceFlush(): Promise<void> {\n    const timeout = this._config.forceFlushTimeoutMillis;\n    const promises = this._registeredSpanProcessors.map(\n      (spanProcessor: SpanProcessor) => {\n        return new Promise(resolve => {\n          let state: ForceFlushState;\n          const timeoutInterval = setTimeout(() => {\n            resolve(\n              new Error(\n                `Span processor did not completed within timeout period of ${timeout} ms`\n              )\n            );\n            state = ForceFlushState.timeout;\n          }, timeout);\n\n          spanProcessor\n            .forceFlush()\n            .then(() => {\n              clearTimeout(timeoutInterval);\n              if (state !== ForceFlushState.timeout) {\n                state = ForceFlushState.resolved;\n                resolve(state);\n              }\n            })\n            .catch(error => {\n              clearTimeout(timeoutInterval);\n              state = ForceFlushState.error;\n              resolve(error);\n            });\n        });\n      }\n    );\n\n    return new Promise<void>((resolve, reject) => {\n      Promise.all(promises)\n        .then(results => {\n          const errors = results.filter(\n            result => result !== ForceFlushState.resolved\n          );\n          if (errors.length > 0) {\n            reject(errors);\n          } else {\n            resolve();\n          }\n        })\n        .catch(error => reject([error]));\n    });\n  }\n\n  shutdown(): Promise<void> {\n    return this.activeSpanProcessor.shutdown();\n  }\n\n  /**\n   * TS cannot yet infer the type of this.constructor:\n   * https://github.com/Microsoft/TypeScript/issues/3841#issuecomment-337560146\n   * There is no need to override either of the getters in your child class.\n   * The type of the registered component maps should be the same across all\n   * classes in the inheritance tree.\n   */\n  protected _getPropagator(name: string): TextMapPropagator | undefined {\n    return (\n      this.constructor as typeof BasicTracerProvider\n    )._registeredPropagators.get(name)?.();\n  }\n\n  protected _getSpanExporter(name: string): SpanExporter | undefined {\n    return (\n      this.constructor as typeof BasicTracerProvider\n    )._registeredExporters.get(name)?.();\n  }\n\n  protected _buildPropagatorFromEnv(): TextMapPropagator | undefined {\n    // per spec, propagators from env must be deduplicated\n    const uniquePropagatorNames = Array.from(\n      new Set(getEnv().OTEL_PROPAGATORS)\n    );\n\n    const propagators = uniquePropagatorNames.map(name => {\n      const propagator = this._getPropagator(name);\n      if (!propagator) {\n        diag.warn(\n          `Propagator \"${name}\" requested through environment variable is unavailable.`\n        );\n      }\n\n      return propagator;\n    });\n    const validPropagators = propagators.reduce<TextMapPropagator[]>(\n      (list, item) => {\n        if (item) {\n          list.push(item);\n        }\n        return list;\n      },\n      []\n    );\n\n    if (validPropagators.length === 0) {\n      return;\n    } else if (uniquePropagatorNames.length === 1) {\n      return validPropagators[0];\n    } else {\n      return new CompositePropagator({\n        propagators: validPropagators,\n      });\n    }\n  }\n\n  protected _buildExporterFromEnv(): SpanExporter | undefined {\n    const exporterName = getEnv().OTEL_TRACES_EXPORTER;\n    if (exporterName === 'none' || exporterName === '') return;\n    const exporter = this._getSpanExporter(exporterName);\n    if (!exporter) {\n      diag.error(\n        `Exporter \"${exporterName}\" requested through environment variable is unavailable.`\n      );\n    }\n    return exporter;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
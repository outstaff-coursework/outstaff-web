{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isPlainObject } from './lodash.merge';\nvar MAX_LEVEL = 20;\n/**\n * Merges objects together\n * @param args - objects / values to be merged\n */\nexport function merge() {\n  var args = [];\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n  var result = args.shift();\n  var objects = new WeakMap();\n  while (args.length > 0) {\n    result = mergeTwoObjects(result, args.shift(), 0, objects);\n  }\n  return result;\n}\nfunction takeValue(value) {\n  if (isArray(value)) {\n    return value.slice();\n  }\n  return value;\n}\n/**\n * Merges two objects\n * @param one - first object\n * @param two - second object\n * @param level - current deep level\n * @param objects - objects holder that has been already referenced - to prevent\n * cyclic dependency\n */\nfunction mergeTwoObjects(one, two, level, objects) {\n  if (level === void 0) {\n    level = 0;\n  }\n  var result;\n  if (level > MAX_LEVEL) {\n    return undefined;\n  }\n  level++;\n  if (isPrimitive(one) || isPrimitive(two) || isFunction(two)) {\n    result = takeValue(two);\n  } else if (isArray(one)) {\n    result = one.slice();\n    if (isArray(two)) {\n      for (var i = 0, j = two.length; i < j; i++) {\n        result.push(takeValue(two[i]));\n      }\n    } else if (isObject(two)) {\n      var keys = Object.keys(two);\n      for (var i = 0, j = keys.length; i < j; i++) {\n        var key = keys[i];\n        result[key] = takeValue(two[key]);\n      }\n    }\n  } else if (isObject(one)) {\n    if (isObject(two)) {\n      if (!shouldMerge(one, two)) {\n        return two;\n      }\n      result = Object.assign({}, one);\n      var keys = Object.keys(two);\n      for (var i = 0, j = keys.length; i < j; i++) {\n        var key = keys[i];\n        var twoValue = two[key];\n        if (isPrimitive(twoValue)) {\n          if (typeof twoValue === 'undefined') {\n            delete result[key];\n          } else {\n            // result[key] = takeValue(twoValue);\n            result[key] = twoValue;\n          }\n        } else {\n          var obj1 = result[key];\n          var obj2 = twoValue;\n          if (wasObjectReferenced(one, key, objects) || wasObjectReferenced(two, key, objects)) {\n            delete result[key];\n          } else {\n            if (isObject(obj1) && isObject(obj2)) {\n              var arr1 = objects.get(obj1) || [];\n              var arr2 = objects.get(obj2) || [];\n              arr1.push({\n                obj: one,\n                key: key\n              });\n              arr2.push({\n                obj: two,\n                key: key\n              });\n              objects.set(obj1, arr1);\n              objects.set(obj2, arr2);\n            }\n            result[key] = mergeTwoObjects(result[key], twoValue, level, objects);\n          }\n        }\n      }\n    } else {\n      result = two;\n    }\n  }\n  return result;\n}\n/**\n * Function to check if object has been already reference\n * @param obj\n * @param key\n * @param objects\n */\nfunction wasObjectReferenced(obj, key, objects) {\n  var arr = objects.get(obj[key]) || [];\n  for (var i = 0, j = arr.length; i < j; i++) {\n    var info = arr[i];\n    if (info.key === key && info.obj === obj) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction isArray(value) {\n  return Array.isArray(value);\n}\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\nfunction isObject(value) {\n  return !isPrimitive(value) && !isArray(value) && !isFunction(value) && typeof value === 'object';\n}\nfunction isPrimitive(value) {\n  return typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean' || typeof value === 'undefined' || value instanceof Date || value instanceof RegExp || value === null;\n}\nfunction shouldMerge(one, two) {\n  if (!isPlainObject(one) || !isPlainObject(two)) {\n    return false;\n  }\n  return true;\n}","map":{"version":3,"names":["isPlainObject","MAX_LEVEL","merge","args","_i","arguments","length","result","shift","objects","WeakMap","mergeTwoObjects","takeValue","value","isArray","slice","one","two","level","undefined","isPrimitive","isFunction","i","j","push","isObject","keys","Object","key","shouldMerge","assign","twoValue","obj1","obj2","wasObjectReferenced","arr1","get","arr2","obj","set","arr","info","Array","Date","RegExp"],"sources":["/home/egor/node_modules/@opentelemetry/core/src/utils/merge.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { isPlainObject } from './lodash.merge';\n\nconst MAX_LEVEL = 20;\n\ninterface ObjectInto {\n  obj: any;\n  key: string;\n}\n\n/**\n * Merges objects together\n * @param args - objects / values to be merged\n */\nexport function merge(...args: any[]): any {\n  let result: any = args.shift();\n  const objects: WeakMap<any, ObjectInto[]> | undefined = new WeakMap<\n    any,\n    ObjectInto[]\n  >();\n  while (args.length > 0) {\n    result = mergeTwoObjects(result, args.shift(), 0, objects);\n  }\n\n  return result;\n}\n\nfunction takeValue(value: any): any {\n  if (isArray(value)) {\n    return value.slice();\n  }\n  return value;\n}\n\n/**\n * Merges two objects\n * @param one - first object\n * @param two - second object\n * @param level - current deep level\n * @param objects - objects holder that has been already referenced - to prevent\n * cyclic dependency\n */\nfunction mergeTwoObjects(\n  one: any,\n  two: any,\n  level = 0,\n  objects: WeakMap<any, ObjectInto[]>\n): any {\n  let result: any;\n  if (level > MAX_LEVEL) {\n    return undefined;\n  }\n  level++;\n  if (isPrimitive(one) || isPrimitive(two) || isFunction(two)) {\n    result = takeValue(two);\n  } else if (isArray(one)) {\n    result = one.slice();\n    if (isArray(two)) {\n      for (let i = 0, j = two.length; i < j; i++) {\n        result.push(takeValue(two[i]));\n      }\n    } else if (isObject(two)) {\n      const keys = Object.keys(two);\n      for (let i = 0, j = keys.length; i < j; i++) {\n        const key = keys[i];\n        result[key] = takeValue(two[key]);\n      }\n    }\n  } else if (isObject(one)) {\n    if (isObject(two)) {\n      if (!shouldMerge(one, two)) {\n        return two;\n      }\n      result = Object.assign({}, one);\n      const keys = Object.keys(two);\n\n      for (let i = 0, j = keys.length; i < j; i++) {\n        const key = keys[i];\n        const twoValue = two[key];\n\n        if (isPrimitive(twoValue)) {\n          if (typeof twoValue === 'undefined') {\n            delete result[key];\n          } else {\n            // result[key] = takeValue(twoValue);\n            result[key] = twoValue;\n          }\n        } else {\n          const obj1 = result[key];\n          const obj2 = twoValue;\n\n          if (\n            wasObjectReferenced(one, key, objects) ||\n            wasObjectReferenced(two, key, objects)\n          ) {\n            delete result[key];\n          } else {\n            if (isObject(obj1) && isObject(obj2)) {\n              const arr1 = objects.get(obj1) || [];\n              const arr2 = objects.get(obj2) || [];\n              arr1.push({ obj: one, key });\n              arr2.push({ obj: two, key });\n              objects.set(obj1, arr1);\n              objects.set(obj2, arr2);\n            }\n\n            result[key] = mergeTwoObjects(\n              result[key],\n              twoValue,\n              level,\n              objects\n            );\n          }\n        }\n      }\n    } else {\n      result = two;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Function to check if object has been already reference\n * @param obj\n * @param key\n * @param objects\n */\nfunction wasObjectReferenced(\n  obj: any,\n  key: string,\n  objects: WeakMap<any, ObjectInto[]>\n): boolean {\n  const arr = objects.get(obj[key]) || [];\n  for (let i = 0, j = arr.length; i < j; i++) {\n    const info = arr[i];\n    if (info.key === key && info.obj === obj) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isArray(value: any): boolean {\n  return Array.isArray(value);\n}\n\nfunction isFunction(value: any): boolean {\n  return typeof value === 'function';\n}\n\nfunction isObject(value: any): boolean {\n  return (\n    !isPrimitive(value) &&\n    !isArray(value) &&\n    !isFunction(value) &&\n    typeof value === 'object'\n  );\n}\n\nfunction isPrimitive(value: any): boolean {\n  return (\n    typeof value === 'string' ||\n    typeof value === 'number' ||\n    typeof value === 'boolean' ||\n    typeof value === 'undefined' ||\n    value instanceof Date ||\n    value instanceof RegExp ||\n    value === null\n  );\n}\n\nfunction shouldMerge(one: any, two: any): boolean {\n  if (!isPlainObject(one) || !isPlainObject(two)) {\n    return false;\n  }\n\n  return true;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}